<app-layout></app-layout>
<div class="container">
  <h2>Liste des Annonces</h2>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>ID</th>
        <th>Titre</th>
        <th>Slug</th>
        <th>Description</th>
        <th>Date de Création</th>
        <th>Image</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let announcement of annoncement">
        <td>{{ announcement.id }}</td>
        <td>{{ announcement.posttitle }}</td>
        <td>{{ announcement.postslug }}</td>
        <td>{{ announcement.postdesc }}</td>
        <td>{{ announcement.creatdate | date:'dd/MM/yyyy' }}</td>
        <td><img [src]="announcement.postimage" alt="Image" width="50" *ngIf="announcement.postimage"></td>
        <td>
          <button (click)="editAnnouncement(announcement)" class="btn btn-warning">Modifier</button>
          <button (click)="deleteAnnouncement(announcement.id!)" class="btn btn-danger">Supprimer</button>
        </td>
      </tr>
    </tbody>
  </table>

  <h2>{{ editMode ? 'Modifier' : 'Ajouter' }} une Annonce</h2>
  <form [formGroup]="announcementForm" (ngSubmit)="submitForm()">
    <div class="form-group">
      <label for="title">Titre</label>
      <input type="text" id="title" class="form-control" formControlName="posttitle" required>
    </div>
    <div class="form-group">
      <label for="slug">Slug</label>
      <input type="text" id="slug" class="form-control" formControlName="postslug" required>
    </div>
    <div class="form-group">
      <label for="image">Image</label>
      <input type="file" id="image" class="form-control" (change)="onFileSelected($event)">
      <img *ngIf="imagePreview" [src]="imagePreview" alt="Aperçu" width="100">
    </div>
    <div class="form-group">
      <label for="desc">Description</label>
      <textarea id="desc" class="form-control" formControlName="postdesc" required></textarea>
    </div>
    <div class="form-group">
      <label for="date">Date de Création</label>
      <input type="datetime-local" id="date" class="form-control" formControlName="creatdate" required>
    </div>
    <button type="submit" class="btn btn-primary">{{ editMode ? 'Mettre à jour' : 'Ajouter' }}</button>
    <button type="button" class="btn btn-secondary" (click)="resetForm()" *ngIf="editMode">Annuler</button>
  </form>
</div>
<app-footer></app-footer>